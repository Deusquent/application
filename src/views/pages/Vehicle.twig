{% extends '../layouts/base.twig' %}

{% block styles %}
    <link rel="stylesheet" href="/asset/css/commun.css">
    <link rel="stylesheet" href="/asset/css/dashboard.css">
{% endblock %}

{% block content %}
    <div class="dashboard-layout">
        <aside class="sidebar">
            <nav class="sidebar-nav">
                <a href="/dashboardUser">Tableau de bord</a>
                <a href="/mes-vehicules" class="active">Mes v√©hicules</a>
                <a href="/calendar">Rendez-vous</a>
                <a href="/documents">Documents</a>
                <a href="/parametres">Param√®tres</a>
            </nav>
            <div class="sidebar-stats">
                <div>V√©hicules
                    <span class="stat-red">{{ vehicles.length }}</span>
                </div>
                <div>KM totaux
                    <span class="stat-blue">{{ totalKm }}</span>
                </div>
                <div>Alertes
                    <span class="stat-yellow">{{ alertCount }}</span>
                </div>
            </div>
        </aside>

        <div class="dashboard-main">
            <section class="dashboard-header">
                <h1>Mes v√©hicules</h1>
                <p>G√©rez et suivez l'entretien de vos v√©hicules</p>
            </section>
            
            <div class="dashboard-actions">
                <div class="search-block">
                    <input type="text" placeholder="Rechercher un v√©hicule..." class="search-input"/>
                    <button class="btn btn-small">üóÇ</button>
                    <button class="btn btn-small">üîΩ</button>
                </div>
                <a href="/addVoiture" class="btn btn-red">+ Ajouter v√©hicule</a>
            </div>

            <div class="dashboard-content-grid">
                <section class="dashboard-block vehicles-block">
                    <div class="vehicles-list">
                        {% if vehicles and vehicles|length > 0 %}
                            <div class="vehicle-grid">
                                {% for vehicle in vehicles %}
                                    <div class="vehicle-card">
                                        <div class="vehicle-icon">
                                            {% if vehicle.photo %}
                                                <img src="{{ vehicle.photo }}" alt="{{ vehicle.marque }} {{ vehicle.model }}">
                                            {% else %}
                                                <div class="vehicle-no-img">Pas de photo</div>
                                            {% endif %}
                                        </div>
                                        <div class="vehicle-info">
                                            <h3>{{ vehicle.marque }} {{ vehicle.model }}</h3>
                                            <p><strong>Type :</strong> {{ vehicle.type }}</p>
                                            <p><strong>Ann√©e :</strong> {{ vehicle.annee }}</p>
                                            <p><strong>Carburant :</strong> {{ vehicle.carburant }}</p>
                                            <p><strong>Kilom√©trage :</strong> {{ vehicle.km }} km</p>
                                            <p><strong>Bo√Æte :</strong> {{ vehicle.boite_de_vitesse }}</p>
                                            <p><strong>Immatriculation :</strong> {{ vehicle.imatriculation }}</p>
                                            
                                            <div class="vehicle-actions">
                                                <form action="/delete-vehicule/{{ vehicle.id }}" method="POST" onsubmit="return confirm('√ätes-vous s√ªr de vouloir supprimer ce v√©hicule ?');">
                                                    <button type="submit" class="btn-small danger">üóë Supprimer</button>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        {% else %}
                            <p>Aucun v√©hicule enregistr√© pour l'instant.</p>
                        {% endif %}
                    </div>
                </section>
            </div>
        </div>
    </div>
{% endblock %}